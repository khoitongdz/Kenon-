local Fluent = loadstring(game:HttpGet("https://raw.githubusercontent.com/khoitongdz/ui/refs/heads/main/.gitignore"))()
local Window = Fluent:CreateWindow({
    Title = "Khoitong dz",
    SubTitle = "Premium",
    TabWidth = 110,
    Size = UDim2.fromOffset(480, 320),
    Acrylic = false,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.End
})

-- Logo
print([[
███████╗ █████╗ ███╗   ██╗
██╔════╝██╔══██╗████╗  ██║
█████╗  ███████║██╔██╗ ██║
██╔══╝  ██╔══██║██║╚██╗██║
███████╗██║  ██║██║ ╚████║
╚══════╝╚═╝  ╚═╝╚═╝  ╚═══╝
]])
print("🔥 Kenon hub🔥")

-- Global Variables
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local replicatedStorage = game:GetService("ReplicatedStorage")
local remoteEvent = replicatedStorage:FindFirstChild("RemoteEvent")
local _G = _G or {}
_G.AutoBone = false
_G.AutoHeal = true
_G.AutoEquipWeapon = true
_G.AutoHaki = false -- Set to true if you want to use Haki automatically
local BoneCFrame = CFrame.new(-9515.75, 174.852, 6079.406)
local BoneCFrame2 = CFrame.new(-9359.453, 141.327, 5446.82)

-- Helper Functions
local function findNearestEnemy()
    local nearestEnemy = nil
    local shortestDistance = math.huge
    for _, enemy in pairs(workspace.Enemies:GetChildren()) do
        if enemy:FindFirstChild("HumanoidRootPart") and enemy:FindFirstChild("Humanoid") and enemy.Humanoid.Health > 0 then
            local distance = (character.HumanoidRootPart.Position - enemy.HumanoidRootPart.Position).Magnitude
            if distance < shortestDistance then
                shortestDistance = distance
                nearestEnemy = enemy
            end
        end
    end
    return nearestEnemy
end

local function attackEnemy(target)
    if target and target:FindFirstChild("HumanoidRootPart") then
        character.HumanoidRootPart.CFrame = target.HumanoidRootPart.CFrame
        if remoteEvent then
            remoteEvent:FireServer("Attack", target)
        else
            warn("RemoteEvent không tồn tại!")
        end
    end
end

local function teleportTo(cframe)
    if character and character:FindFirstChild("HumanoidRootPart") then
        character.HumanoidRootPart.CFrame = cframe
    end
end

local function startQuest()
    if replicatedStorage.Remotes.CommF_ then
        replicatedStorage.Remotes.CommF_:InvokeServer("StartQuest", "HauntedQuest2", 1)
    end
end

local function autoHeal()
    if _G.AutoHeal then
        if character.Humanoid.Health < character.Humanoid.MaxHealth * 0.3 then
            -- Use healing item or ability here, if applicable
            print("Auto Healing...")
        end
    end
end

local function autoEquipWeapon()
    if _G.AutoEquipWeapon then
        -- Equip the best available weapon here (you need to replace this with the actual method)
        print("Equipping best weapon...")
    end
end

local function autoHaki()
    if _G.AutoHaki then
        -- Activate Haki automatically if applicable (replace with actual code)
        print("Activating Haki...")
    end
end

-- Auto Farm Logic
spawn(function()
    while wait(0.1) do
        if _G.AutoBone then
            pcall(function()
                local target = findNearestEnemy()
                if target then
                    attackEnemy(target)
                else
                    -- Teleport to quest area if no target found
                    if (character.HumanoidRootPart.Position - BoneCFrame.Position).Magnitude > 3 then
                        teleportTo(BoneCFrame)
                        startQuest()
                    end
                end
            end)
        end

        -- Auto Heal Logic
        autoHeal()

        -- Auto Equip Weapon Logic
        autoEquipWeapon()

        -- Auto Haki Logic
        autoHaki()
    end
end)

-- UI Toggles
local ToggleAutoFarm = Window:AddToggle("Auto Farm Bone", {
    Title = "Auto Farm Bone",
    Default = false
})
ToggleAutoFarm:OnChanged(function(Value)
    _G.AutoBone = Value
end)

local ToggleAutoHeal = Window:AddToggle("Auto Heal", {
    Title = "Auto Heal",
    Default = true
})
ToggleAutoHeal:OnChanged(function(Value)
    _G.AutoHeal = Value
end)

local ToggleEquipWeapon = Window:AddToggle("Auto Equip Best Weapon", {
    Title = "Auto Equip Best Weapon",
    Default = true
})
ToggleEquipWeapon:OnChanged(function(Value)
    _G.AutoEquipWeapon = Value
end)

local ToggleAutoHaki = Window:AddToggle("Auto Haki", {
    Title = "Auto Haki",
    Default = false
})
ToggleAutoHaki:OnChanged(function(Value)
    _G.AutoHaki = Value
end)

-- Anti-AFK (optional)
spawn(function()
    while true do
        wait(60)  -- Every 60 seconds, move the character slightly to prevent AFK
        character.HumanoidRootPart.CFrame = character.HumanoidRootPart.CFrame * CFrame.new(0, 0, 1)
    end
end)
